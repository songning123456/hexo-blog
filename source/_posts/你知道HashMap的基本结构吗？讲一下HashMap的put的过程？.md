---
title: 你知道HashMap的基本结构吗？讲一下HashMap的put的过程？
date: 2021-01-14 18:58:20
tags: [面试, Java]
category: [面试, Java, 集合]
---

# 数组+链表+红黑树

对key求Hash值，然后再计算下标；
如果没有碰撞，直接放入桶中；
如果碰撞了，以链表的方式链接到后面；
如果链表长度超过阀值(TREEIFY_THRESHOLD == 8)，就把链表转成红黑树；
如果节点已经存在就替换旧值；
如果桶满了(容量 * 加载因子)，就需要resize。

{% asset_img HashMap.jpg %}

# 红黑树的5个特性

每个节点或者是黑色，或者是红色；
根节点是黑色；
每个叶子节点是黑色；
如果一个节点是红色的，则它的子节点必须是黑色；
从一个节点到该节点的子孙节点的所有路径上包含相同数目的黑节点。(这里指到叶子节点的路径)

# 思考：扩容后，原始值所在的位置？

答：元素的下标要么**不变**，要么变为**原下标+原容量**。
