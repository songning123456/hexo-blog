---
title: 如何合理的配置线程池？
date: 2021-01-14 22:20:21
tags: [面试, Java]
category: [面试, Java, 线程]
---

# 任务的性质

## CPU密集型任务

配置尽可能少的线程数量，如配置Ncpu+1个线程的线程池。

## IO密集型任务

由于需要等待IO操作，线程并不是一直在执行任务，则配置尽可能多的线程，如2*Ncpu。

## 混合型任务

如果可以拆分，则将其拆分成一个CPU密集型任务和一个IO密集型任务，只要这两个任务执行的时间相差不是太大，那么分解后执行的吞吐率要高于串行执行的吞吐率，如果这两个任务执行时间相差太大，则没必要进行分解。我们可以通过Runtime.getRuntime().availableProcessors()方法获得当前设备的CPU个数。

# 任务的优先级	

## 高，中和低

使用优先级队列PriorityBlockingQueue来处理。它可以让优先级高的任务先得到执行，需要注意的是如果一直有优先级高的任务提交到队列里，那么优先级低的任务可能永远不能执行。

# 任务的执行时间

## 长，中和短

交给不同规模的线程池来处理，或者也可以使用优先级队列，让执行时间短的任务先执行。

# 任务的依赖性

## 是否依赖其他系统资源，如数据库连接

依赖数据库连接池的任务，因为线程提交SQL后需要等待数据库返回结果，如果等待的时间越长CPU空闲时间就越长，那么线程数应该设置越大，这样才能更好的利用CPU。
