---
title: DeepPaging操作的问题？
date: 2021-01-16 09:20:37
tags: [面试, Elasticsearch]
category: [面试, Elasticsearch]
---

简单说就是搜索特别深导致性能低下的问题。

比如总共60000条数据，3个shard，每个shard分2W条，每页10条，如果要搜到1000页时，取的是第几条到第几条数据？实际上每个shard都要将内部的2W条数据的第10001~10010条拿出来，不是10条，是10010条取出，3个shard都返回10010条数据给coordinate node，这个协调节点共收到30030条，再进行排序。_score，相关度分数，然后取到排位最高的前10条数据，这就是我们要的第1000页的10条数据。这个过程耗费网络带宽，内存，CPU，有大量性能问题，所以要避免deep paging操作。

